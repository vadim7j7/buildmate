{"id": "cr-001", "prompt": "Review this Rails controller for security issues:\n```ruby\nclass UsersController < ApplicationController\n  def update\n    user = User.find(params[:id])\n    user.update(params[:user])\n    render json: user\n  end\nend\n```", "expected_behavior": "Should identify: mass assignment vulnerability (no strong params), missing authorization check, no error handling", "stack": "rails", "rubric": "Must identify mass assignment as BLOCKER. Should note missing authorization. Should suggest error handling. Should recommend strong parameters pattern (user_params private method)."}
{"id": "cr-002", "prompt": "Review this React component for security and quality issues:\n```jsx\nfunction UserProfile({ userId }) {\n  const [user, setUser] = useState(null);\n\n  useEffect(() => {\n    fetch(`/api/users/${userId}`)\n      .then(res => res.json())\n      .then(data => setUser(data));\n  });\n\n  return (\n    <div>\n      <h1>{user?.name}</h1>\n      <div dangerouslySetInnerHTML={{ __html: user?.bio }} />\n      <p>{user?.email}</p>\n    </div>\n  );\n}\n```", "expected_behavior": "Should identify: XSS vulnerability via dangerouslySetInnerHTML, missing useEffect dependency array causing infinite re-renders, no loading/error states, no fetch error handling", "stack": "react", "rubric": "Must flag dangerouslySetInnerHTML XSS as BLOCKER. Must catch missing dependency array in useEffect. Should suggest loading and error states. Should recommend DOMPurify or alternative rendering."}
{"id": "cr-003", "prompt": "Review this Rails model and controller for N+1 query issues:\n```ruby\nclass PostsController < ApplicationController\n  def index\n    @posts = Post.all\n    render json: @posts.map { |post|\n      {\n        id: post.id,\n        title: post.title,\n        author_name: post.author.name,\n        comments_count: post.comments.count,\n        tags: post.tags.pluck(:name)\n      }\n    }\n  end\nend\n```", "expected_behavior": "Should identify N+1 queries on author, comments, and tags. Should suggest eager loading with includes/preload. Should recommend counter_cache for comments_count.", "stack": "rails", "rubric": "Must identify all three N+1 query issues (author, comments, tags). Should suggest Post.includes(:author, :comments, :tags). Should mention counter_cache as optimization. Should note potential pagination need for Post.all."}
{"id": "cr-004", "prompt": "Review this TypeScript service for type safety and error handling:\n```typescript\nasync function fetchUserData(id: any): Promise<any> {\n  const response = await fetch(`/api/users/${id}`);\n  const data = await response.json();\n  return data;\n}\n\nasync function processUsers(ids: any[]) {\n  const results = [];\n  for (const id of ids) {\n    const user = await fetchUserData(id);\n    results.push(user);\n  }\n  return results;\n}\n\nexport function getUserAge(user: any): number {\n  return new Date().getFullYear() - new Date(user.birthDate).getFullYear();\n}\n```", "expected_behavior": "Should identify: excessive use of 'any' type, no response status checking, sequential awaits instead of Promise.all, age calculation is incorrect (does not account for month/day), no error handling for invalid dates", "stack": "typescript", "rubric": "Must flag all 'any' types and suggest proper interfaces/types. Should catch missing HTTP error handling. Should suggest Promise.all for parallel requests. Should note the incorrect age calculation logic. Should suggest input validation."}
{"id": "cr-005", "prompt": "Review this Express.js middleware for security:\n```javascript\nconst express = require('express');\nconst app = express();\n\napp.use(express.json());\n\napp.post('/login', (req, res) => {\n  const { username, password } = req.body;\n  const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n  db.query(query, (err, results) => {\n    if (results.length > 0) {\n      const token = username + ':' + Date.now();\n      res.json({ token: Buffer.from(token).toString('base64') });\n    } else {\n      res.status(401).json({ error: 'Invalid credentials' });\n    }\n  });\n});\n\napp.listen(3000);\n```", "expected_behavior": "Should identify: SQL injection vulnerability, plaintext password storage/comparison, insecure token generation (not JWT/crypto), no rate limiting, no input validation, no HTTPS enforcement, missing CORS/helmet configuration", "stack": "node", "rubric": "Must flag SQL injection as CRITICAL. Must flag plaintext password comparison (should use bcrypt). Must flag insecure token generation. Should recommend parameterized queries, proper JWT, rate limiting, and helmet middleware."}
{"id": "cr-006", "prompt": "Review this Python FastAPI endpoint:\n```python\nfrom fastapi import FastAPI\nimport subprocess\nimport os\n\napp = FastAPI()\n\n@app.post(\"/run-report\")\nasync def run_report(report_name: str, params: str = \"\"):\n    cmd = f\"python reports/{report_name}.py {params}\"\n    result = subprocess.run(cmd, shell=True, capture_output=True, text=True)\n    return {\"output\": result.stdout, \"error\": result.stderr}\n\n@app.get(\"/download/{filename}\")\nasync def download_file(filename: str):\n    filepath = f\"/app/data/{filename}\"\n    with open(filepath, 'r') as f:\n        return {\"content\": f.read()}\n```", "expected_behavior": "Should identify: command injection via shell=True with user input, path traversal vulnerability in download endpoint, no authentication, no input sanitization, stderr exposure leaks system info", "stack": "python", "rubric": "Must flag command injection as CRITICAL (shell=True with unsanitized input). Must flag path traversal (../../../etc/passwd). Should note missing authentication. Should recommend shlex.quote or avoiding shell=True entirely. Should suggest pathlib for safe path resolution."}
{"id": "cr-007", "prompt": "Review this React component for performance:\n```jsx\nimport React from 'react';\n\nfunction ProductList({ products, filters, onProductClick }) {\n  const filteredProducts = products.filter(p => {\n    return filters.every(f => p.tags.includes(f));\n  });\n\n  const sortedProducts = [...filteredProducts].sort((a, b) => {\n    return a.price - b.price;\n  });\n\n  const formatPrice = (price) => {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD'\n    }).format(price);\n  };\n\n  return (\n    <div>\n      {sortedProducts.map(product => (\n        <div key={product.id} onClick={() => onProductClick(product)}>\n          <img src={product.imageUrl} />\n          <h3>{product.name}</h3>\n          <p>{formatPrice(product.price)}</p>\n          <ul>\n            {product.tags.map(tag => <li>{tag}</li>)}\n          </ul>\n        </div>\n      ))}\n    </div>\n  );\n}\n\nexport default ProductList;\n```", "expected_behavior": "Should identify: filtering and sorting on every render (needs useMemo), Intl.NumberFormat created per call, inline arrow function in onClick creates new reference each render (needs useCallback), missing key on tag li elements, images have no alt text, no virtualization for large lists", "stack": "react", "rubric": "Should recommend useMemo for filteredProducts and sortedProducts. Should suggest caching Intl.NumberFormat instance. Should note missing key prop on tag list items. Should mention useCallback for onProductClick handler. Should flag missing alt attributes on images for accessibility."}
{"id": "cr-008", "prompt": "Review this Rails model with validations and callbacks:\n```ruby\nclass Order < ApplicationRecord\n  belongs_to :user\n  has_many :line_items\n\n  before_save :calculate_total\n  after_create :send_confirmation_email\n  after_save :update_inventory\n  after_save :sync_to_warehouse_api\n  after_save :recalculate_user_loyalty_points\n\n  def calculate_total\n    self.total = line_items.sum(:price)\n  end\n\n  def send_confirmation_email\n    OrderMailer.confirmation(self).deliver_now\n  end\n\n  def update_inventory\n    line_items.each do |item|\n      item.product.update(stock: item.product.stock - item.quantity)\n    end\n  end\n\n  def sync_to_warehouse_api\n    WarehouseApi.new.sync_order(self)\n  end\n\n  def recalculate_user_loyalty_points\n    user.update(loyalty_points: user.orders.sum(:total) * 0.01)\n  end\nend\n```", "expected_behavior": "Should identify: too many callbacks creating hidden complexity, synchronous email delivery blocking request, external API call in callback (fragile), N+1 in update_inventory, no error handling in callbacks, race conditions on inventory update, loyalty points calculation queries all orders every save", "stack": "rails", "rubric": "Must flag synchronous email delivery (should use deliver_later). Must flag external API call in callback (should use background job). Should identify N+1 query in update_inventory. Should suggest moving side effects to service objects. Should note race condition on stock update (needs locking). Should recommend against heavy callback chains."}
